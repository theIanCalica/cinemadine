{"ast":null,"code":"import * as e from \"react\";\nvar t = function () {\n    var e = {\n        name: \"__LSM__\",\n        middleWares: [],\n        persist: \"action\"\n      },\n      t = {};\n    try {\n      e.storageType = \"undefined\" != typeof sessionStorage ? window.sessionStorage : void 0;\n    } catch (e) {}\n    return {\n      updateStore: function (n) {\n        try {\n          t = e.storageType && JSON.parse(e.storageType.getItem(e.name) || \"\") || n;\n        } catch (e) {\n          t = n;\n        }\n      },\n      saveStore: function () {\n        e.storageType && e.storageType.setItem(e.name, JSON.stringify(t));\n      },\n      get state() {\n        return t;\n      },\n      set state(e) {\n        t = e;\n      },\n      get options() {\n        return e;\n      },\n      set options(t) {\n        e = t;\n      }\n    };\n  }(),\n  n = e.createContext(void 0),\n  o = function (o) {\n    var r = o.children,\n      s = e.useState(t.state),\n      a = s[0],\n      i = s[1];\n    return e.useEffect(function () {\n      \"beforeUnload\" === t.options.persist && (window.onbeforeunload = function () {\n        return t.saveStore();\n      }, t.options.storageType && t.options.storageType.removeItem(t.options.name));\n    }, []), e.createElement(n.Provider, {\n      value: {\n        state: a,\n        setState: i\n      }\n    }, r);\n  };\nfunction r() {\n  return r = Object.assign || function (e) {\n    for (var t = 1; t < arguments.length; t++) {\n      var n = arguments[t];\n      for (var o in n) Object.prototype.hasOwnProperty.call(n, o) && (e[o] = n[o]);\n    }\n    return e;\n  }, r.apply(this, arguments);\n}\nfunction s(e, n) {\n  n && (t.options = r({}, t.options, n)), \"production\" !== process.env.NODE_ENV && \"undefined\" != typeof window && (window.__LSM_NAME__ = t.options.name, window.__LSM_RESET__ = function () {\n    return t.options.storageType && t.options.storageType.removeItem(t.options.name);\n  }), t.updateStore(e);\n}\nfunction a(o) {\n  var r = e.useContext(n),\n    s = r.state,\n    a = r.setState,\n    i = e.useRef(Object.entries(o || {}).reduce(function (e, n) {\n      var o;\n      return Object.assign({}, e, ((o = {})[n[0]] = function (e, n) {\n        return function (o, r) {\n          \"production\" !== process.env.NODE_ENV && (window.__LSM_NAME__ = n.name), t.state = n(t.state, o), t.options.middleWares && (t.state = t.options.middleWares.reduce(function (e, t) {\n            return t(e, n.name, o) || e;\n          }, t.state)), (!r || !r.skipRender) && e(t.state), \"action\" === t.options.persist && t.saveStore();\n        };\n      }(a, n[1]), o));\n    }, {}));\n  return {\n    actions: i.current,\n    state: s,\n    getState: e.useCallback(function () {\n      return t.state;\n    }, [])\n  };\n}\nexport { o as StateMachineProvider, s as createStore, a as useStateMachine };","map":{"version":3,"names":["e","name","middleWares","persist","t","storageType","sessionStorage","window","updateStore","n","JSON","parse","getItem","saveStore","setItem","stringify","state","options","createContext","o","StateMachineProvider","r","children","s","useState","a","i","useEffect","onbeforeunload","removeItem","createElement","Provider","value","setState","Object","assign","arguments","length","prototype","hasOwnProperty","call","apply","process","env","NODE_ENV","__LSM_NAME__","__LSM_RESET__","useContext","useRef","entries","reduce","skipRender","actions","current","getState","useCallback","createStore","useStateMachine"],"sources":["C:\\School\\3rd year\\cinemadine\\frontend\\node_modules\\little-state-machine\\src\\logic\\storeFactory.ts","C:\\School\\3rd year\\cinemadine\\frontend\\node_modules\\little-state-machine\\src\\constants.ts","C:\\School\\3rd year\\cinemadine\\frontend\\node_modules\\little-state-machine\\src\\StateMachineContext.tsx","C:\\School\\3rd year\\cinemadine\\frontend\\node_modules\\little-state-machine\\src\\stateMachine.tsx"],"sourcesContent":["import { PERSIST_OPTION, STORE_DEFAULT_NAME } from '../constants';\nimport { GlobalState, StateMachineOptions } from '../types';\n\nfunction StoreFactory() {\n  let options: StateMachineOptions = {\n    name: STORE_DEFAULT_NAME,\n    middleWares: [],\n    persist: PERSIST_OPTION.ACTION,\n  };\n  let state: GlobalState = {};\n\n  try {\n    options.storageType =\n      typeof sessionStorage !== 'undefined' ? window.sessionStorage : undefined;\n  } catch {}\n\n  return {\n    updateStore(defaultValues: GlobalState) {\n      try {\n        state =\n          (options.storageType &&\n            JSON.parse(options.storageType.getItem(options.name!) || '')) ||\n          defaultValues;\n      } catch {\n        state = defaultValues;\n      }\n    },\n    saveStore() {\n      options.storageType &&\n        options.storageType.setItem(options.name!, JSON.stringify(state));\n    },\n    get state() {\n      return state;\n    },\n    set state(value) {\n      state = value;\n    },\n    get options() {\n      return options;\n    },\n    set options(value) {\n      options = value;\n    },\n  };\n}\n\nexport default StoreFactory();\n","export const STORE_DEFAULT_NAME = '__LSM__';\nexport const STORE_ACTION_NAME = '__LSM_NAME__';\nexport const PERSIST_OPTION = {\n  NONE: 'none',\n  ACTION: 'action',\n  UNLOAD: 'beforeUnload',\n} as const;\n","import * as React from 'react';\nimport storeFactory from './logic/storeFactory';\nimport { StateMachineContextValue } from './types';\nimport { PERSIST_OPTION } from './constants';\n\ntype PropsChildren = {\n  children?: React.ReactNode;\n};\n\nconst StateMachineContext = React.createContext<StateMachineContextValue>(\n  undefined as any,\n);\n\nexport const StateMachineProvider: React.FC<PropsChildren> = ({ children }) => {\n  const [state, setState] = React.useState(storeFactory.state);\n\n  React.useEffect(() => {\n    if (storeFactory.options.persist === PERSIST_OPTION.UNLOAD) {\n      window.onbeforeunload = () => storeFactory.saveStore();\n      storeFactory.options.storageType &&\n        storeFactory.options.storageType.removeItem(storeFactory.options.name!);\n    }\n  }, []);\n\n  return (\n    <StateMachineContext.Provider value={{ state, setState }}>\n      {children}\n    </StateMachineContext.Provider>\n  );\n};\n\nexport const useStateMachineContext = () =>\n  React.useContext<StateMachineContextValue>(StateMachineContext);\n","import * as React from 'react';\nimport { useStateMachineContext } from './StateMachineContext';\nimport storeFactory from './logic/storeFactory';\nimport {\n  StateMachineOptions,\n  GlobalState,\n  AnyCallback,\n  AnyActions,\n  ActionsOutput,\n} from './types';\nimport { PERSIST_OPTION, STORE_ACTION_NAME } from './constants';\n\nexport function createStore(\n  defaultState: GlobalState,\n  options?: StateMachineOptions,\n) {\n  if (options) {\n    storeFactory.options = {\n      ...storeFactory.options,\n      ...options,\n    };\n  }\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (typeof window !== 'undefined') {\n      window.__LSM_NAME__ = storeFactory.options.name;\n      window.__LSM_RESET__ = () =>\n        storeFactory.options.storageType &&\n        storeFactory.options.storageType.removeItem(storeFactory.options.name!);\n    }\n  }\n\n  storeFactory.updateStore(defaultState);\n}\n\nconst actionTemplate =\n  <TCallback extends AnyCallback>(\n    setState: React.Dispatch<React.SetStateAction<GlobalState>>,\n    callback: TCallback,\n  ) =>\n  (payload: Parameters<TCallback>[1], options?: { skipRender: boolean }) => {\n    if (process.env.NODE_ENV !== 'production') {\n      window[STORE_ACTION_NAME] = callback.name;\n    }\n\n    storeFactory.state = callback(storeFactory.state, payload);\n\n    if (storeFactory.options.middleWares) {\n      storeFactory.state = storeFactory.options.middleWares.reduce(\n        (currentValue, currentFunction) =>\n          currentFunction(currentValue, callback.name, payload) || currentValue,\n        storeFactory.state,\n      );\n    }\n\n    (!options || !options.skipRender) && setState(storeFactory.state);\n\n    if (storeFactory.options.persist === PERSIST_OPTION.ACTION) {\n      storeFactory.saveStore();\n    }\n  };\n\nexport function useStateMachine<\n  TCallback extends AnyCallback,\n  TActions extends AnyActions<TCallback>,\n>(\n  actions?: TActions,\n): {\n  actions: ActionsOutput<TCallback, TActions>;\n  state: GlobalState;\n  getState: () => GlobalState;\n} {\n  const { state, setState } = useStateMachineContext();\n  const actionsRef = React.useRef(\n    Object.entries(actions || {}).reduce(\n      (previous, [key, callback]) =>\n        Object.assign({}, previous, {\n          [key]: actionTemplate(setState, callback),\n        }),\n      {} as ActionsOutput<TCallback, TActions>,\n    ),\n  );\n\n  return {\n    actions: actionsRef.current,\n    state,\n    getState: React.useCallback(() => storeFactory.state, []),\n  };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}